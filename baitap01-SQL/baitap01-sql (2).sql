--2. TRUY VAN CAC CAU SAU:
-- 2.1. TIM CAC KHACH HANG CO SO LUONG MUA HANG
--NHIEU NHAT TRONG KHOANG THOI GIAN TU '01/01/2013' DEN '31/01/2013'
use TBL
GO
SELECT *
INTO #tblBanHang
FROM BanHang
WHERE NGAY_CT BETWEEN '2013-01-01' AND '2013-01-31'

-- Select rows from a Table or View '[TableOrViewName]' in schema '[dbo]'
SELECT *
FROM [#tblBanHang]
WHERE #tblBanHang.SO_LUONG=(select MAX(#tblBanHang.SO_LUONG)
from #tblBanHang)

--2.2. TIM 10 KHACH HANG CO DOANH SO BAN NHIEU NHAT TRONG 
--KHOANG THOI GIAN TU '01/01/2013' DEN '31/01/2013'
SELECT TOP 10
    *, ''AS _10KHACH_MUAHANGNHIEUNHAT
FROM
    BanHang
WHERE NGAY_CT BETWEEN '2013-01-01' AND '2013-01-31'
ORDER BY SO_LUONG DESC

--2.3. TIM MAT HANG NAO BAN CHAY NHAT TRONG 
--KHOANG THOI GIAN TU '01/01/2013' DEN '31/01/2013'
--SELECT MAX(SO_LUONG) FROM CMT
SELECT *
into #tblBanHang1
FROM BanHang
WHERE NGAY_CT BETWEEN '20130101' and '20130131'

-- Select rows from a Table or View '[TableOrViewName]' in schema '[dbo]'
SELECT *
FROM [#tblBanHang1]
WHERE TIEN = (select max(TIEN)
from #tblBanHang1)

GO